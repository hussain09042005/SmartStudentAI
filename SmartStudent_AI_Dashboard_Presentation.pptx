from pptx import Presentation
from pptx.util import Pt
from pptx.dml.color import RGBColor

# Create the presentation
prs = Presentation()
title_slide_layout = prs.slide_layouts[0]
bullet_slide_layout = prs.slide_layouts[1]

# Font configuration
TITLE_FONT_SIZE = Pt(40)
BODY_FONT_SIZE = Pt(22)
TITLE_COLOR = RGBColor(30, 30, 120)

def set_text_style(paragraph, font_size=BODY_FONT_SIZE, bold=False):
    run = paragraph.runs[0]
    run.font.size = font_size
    run.font.bold = bold
    run.font.name = 'Calibri'
    run.font.color.rgb = RGBColor(50, 50, 50)

def add_bullet_slide(title, bullets):
    slide = prs.slides.add_slide(bullet_slide_layout)
    slide.shapes.title.text = title
    title_shape = slide.shapes.title
    title_shape.text_frame.paragraphs[0].font.size = TITLE_FONT_SIZE
    title_shape.text_frame.paragraphs[0].font.color.rgb = TITLE_COLOR

    body_shape = slide.shapes.placeholders[1]
    tf = body_shape.text_frame
    tf.clear()
    for i, bullet in enumerate(bullets):
        p = tf.add_paragraph() if i > 0 else tf.paragraphs[0]
        p.text = bullet
        p.level = 0
        set_text_style(p)

# Title Slide
slide = prs.slides.add_slide(title_slide_layout)
slide.shapes.title.text = "SmartStudent AI\nPredictive Academic Dashboard"
slide.placeholders[1].text = (
    "ğŸ“Š Powered by Streamlit + Scikit-learn\n\n"
    "ğŸ‘¨â€ğŸ’» Mohammed Hussain Kamal Ahmed Choudhary\n"
    "ğŸ“§ choudharyhussain11@gmail.com\n\n"
    "By: Team Data Decoders"
)

# Slides
add_bullet_slide("ğŸ“Œ Project Overview", [
    "AI-powered dashboard for academic prediction",
    "Upload CSV to predict pass/fail outcomes",
    "Visual analytics & model retraining options",
    "Secure admin login + email system"
])

add_bullet_slide("ğŸ§° Tech Stack", [
    "ğŸ” Scikit-learn â€“ Predictive ML Model",
    "ğŸ“Š Streamlit â€“ Dashboard (Frontend)",
    "ğŸ“¦ Pandas, NumPy â€“ Data handling",
    "ğŸ“ˆ Plotly, Seaborn, Matplotlib â€“ Visuals",
    "ğŸ“§ SMTP (Gmail App Passwords) â€“ Emailing",
    "â˜ï¸ Streamlit Cloud + GitHub â€“ Hosting & CI"
])

add_bullet_slide("âœ¨ Core Features", [
    "ğŸ“ Upload CSV & Predict pass/fail",
    "ğŸ“ˆ Visual reports: heatmaps, histograms",
    "ğŸ“Š Advanced insights: boxplots, trend lines",
    "ğŸ”„ Retrain model with sample data",
    "ğŸ›¡ï¸ Secure admin login to view messages"
])

add_bullet_slide("ğŸ“Š Dashboard Components", [
    "âœ… CSV Upload and Live Predictions",
    "ğŸ“‰ Visual Analytics â€“ Pie, Bar, Heatmaps",
    "ğŸ§  Model Retraining Interface",
    "âœ‰ï¸ Contact Form + Auto Reply via Email",
    "ğŸ§¾ Message Logging with timestamps"
])

add_bullet_slide("ğŸ” Admin & Email Features", [
    "ğŸ›¡ï¸ Secure Login Panel for Admin",
    "ğŸ“§ Auto-email reply to contact form users",
    "ğŸ“¥ Admin inbox view with logs",
    "ğŸ§¾ Timestamps & user message history stored"
])

add_bullet_slide("ğŸ“ˆ Visual Insights", [
    "ğŸ“Š Pie Charts â€“ Pass/Fail Ratio",
    "ğŸ“‰ Histograms â€“ Score Distribution",
    "ğŸ”¥ Heatmaps â€“ Feature Correlation",
    "ğŸ“¦ Boxplots â€“ Score Spread",
    "ğŸ“ˆ Trends â€“ Performance Over Time"
])

add_bullet_slide("ğŸš€ Deployment & Setup", [
    "â˜ï¸ Hosted on Streamlit Cloud",
    "ğŸ”— Repo on GitHub",
    "ğŸ“„ Required: requirements.txt, runtime.txt",
    "ğŸ” Secrets stored in .streamlit/secrets.toml",
    "âš™ï¸ Python 3.10+ environment"
])

add_bullet_slide("ğŸ§ª Demo Flow", [
    "1. Admin logs in securely",
    "2. User uploads academic CSV",
    "3. Model predicts and shows results",
    "4. Dashboard auto-generates visual insights",
    "5. Contact form submits email + auto-reply",
    "6. Admin reviews logs and queries"
])

add_bullet_slide("ğŸ‘¥ Team & Contact", [
    "ğŸ‘¨â€ğŸ’» Mohammed Hussain Kamal Ahmed Choudhary",
    "ğŸ“§ choudharyhussain11@gmail.com",
    "ğŸ‘¨â€ğŸ”§ Team Name: Data Decoders",
    "ğŸŒ GitHub | Streamlit | Email Links"
])

